@using Microsoft.AspNetCore.Components.Forms
@using Oqtane.Modules.Controls
@using OE.Module.LHB.Services
@using System.ComponentModel.DataAnnotations

@namespace OE.Provider
@inherits ModuleBase
@inject ProviderService ProviderService
@inject AddressService AddressService
@inject NavigationManager NavigationManager
@inject IStringLocalizer<Index> Localizer

<Address Addr="@addr"></Address>
<MudButton Color="Color.Primary" OnClick="@(()=> AddAddr())">@Localizer["Add"]</MudButton>
<MudButton Color="Color.Secondary" OnClick="@(()=> Back())">@Localizer["Cancel"]</MudButton>


@code {
    MudForm form;
    // public override SecurityAccessLevel SecurityAccessLevel => SecurityAccessLevel.Edit;

    public override string Actions => "AddAddress";
    public override bool UseAdminContainer => true;  //popup
    public override string Title => "Manage Address";
    private int _id;
    private M.Address addr = new();

    bool success;
    string[] errors = { };

    protected override async Task OnInitializedAsync()
    {
        _id = int.Parse(PageState.QueryString["id"]);
    }

    private void Back()
    {
        var url = EditUrl("Detail", $"id={_id}");
        NavigationManager.NavigateTo(url);
    }

    private void AddAddr()
    {
        AddressService.AddAddressAsync(addr);
    }
}
