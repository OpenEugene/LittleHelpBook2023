@using OE.Module.LHB.Services

@namespace OE.Provider
@inherits ModuleBase
@inject PhoneNumberService PhoneNumberService
@inject NavigationManager NavigationManager
@inject IStringLocalizer<Index> Localizer

<PhoneNumber Phone="@_phone"></PhoneNumber>
<MudButton Color="Color.Primary" OnClick="@(()=> AddPhone())">@Localizer["Save"]</MudButton>
<MudButton Color="Color.Secondary" OnClick="@(()=> Back())">@Localizer["Cancel"]</MudButton>


@code {
    public override string Actions => "AddPhone";
    public override bool UseAdminContainer => true;  //popup
    public override string Title => "Manage PhoneNumber";
    private int _id;
    private readonly M.PhoneNumber _phone = new();
    
    protected override async Task OnInitializedAsync()
    {
        _id = int.Parse(PageState.QueryString["id"]);
    }

    private void Back()
    {
        var url = EditUrl("Detail", $"id={_id}");
        NavigationManager.NavigateTo(url);
    }

    private async Task AddPhone()
    {
        _phone.ProviderId = _id;
        var returnPhoneNumber = await PhoneNumberService.AddPhoneNumberAsync(_phone);
        
        Back();
    }
}
